business_unit: sales

projects:
  - name: crm-platform
    description: CRM platform infrastructure
    
    var_sets:
      variables:
        - key: environment
          value: production
          category: terraform
        
        - key: team
          value: sales-ops
          category: terraform
    
    workspaces:
      - name: crm-database
        description: CRM database (Aurora PostgreSQL)
        terraform_version: "1.9.0"
        working_directory: "terraform/database"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/database/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/crm-platform"
          branch: "main"
        
        variables:
          - key: db_engine
            value: aurora-postgresql
            category: terraform
          
          - key: db_version
            value: "15.3"
            category: terraform
          
          - key: cluster_instances
            value: "3"
            category: terraform
          
          - key: backup_retention
            value: "14"
            category: terraform
      
      - name: crm-api
        description: CRM REST API infrastructure
        terraform_version: "1.9.0"
        working_directory: "terraform/api"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/api/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/crm-platform"
          branch: "main"
        
        variables:
          - key: api_gateway_type
            value: alb
            category: terraform
          
          - key: api_instances
            value: "3"
            category: terraform
          
          - key: health_check_interval
            value: "30"
            category: terraform

  - name: analytics-pipeline
    description: Sales analytics and data pipeline
    
    var_sets:
      variables:
        - key: environment
          value: production
          category: terraform
        
        - key: data_classification
          value: internal
          category: terraform
    
    workspaces:
      - name: analytics-etl
        description: ETL pipeline for sales data
        terraform_version: "1.9.0"
        working_directory: "terraform/etl"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/etl/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/sales-analytics"
          branch: "main"
        
        variables:
          - key: etl_schedule
            value: "0 */4 * * *"
            category: terraform
            description: "Every 4 hours"
          
          - key: data_sources
            value: '["crm", "email", "calendar"]'
            category: terraform
            hcl: true
      
      - name: analytics-warehouse
        description: Data warehouse (Redshift)
        terraform_version: "1.9.0"
        working_directory: "terraform/warehouse"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/warehouse/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/sales-analytics"
          branch: "main"
        
        variables:
          - key: node_type
            value: ra3.xlplus
            category: terraform
          
          - key: number_of_nodes
            value: "2"
            category: terraform
          
          - key: automated_snapshot_retention
            value: "7"
            category: terraform

  - name: sales-portal
    description: Customer-facing sales portal
    
    var_sets:
      variables:
        - key: environment
          value: production
          category: terraform
    
    workspaces:
      - name: sales-portal-frontend
        description: Sales portal frontend (CloudFront + S3)
        terraform_version: "1.9.0"
        working_directory: "terraform/frontend"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/frontend/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/sales-portal"
          branch: "main"
        
        variables:
          - key: cdn_enabled
            value: "true"
            category: terraform
          
          - key: waf_enabled
            value: "true"
            category: terraform
          
          - key: certificate_arn
            value: arn:aws:acm:us-east-1:123456789012:certificate/abcd1234
            category: terraform
      
      - name: sales-portal-backend
        description: Sales portal backend API
        terraform_version: "1.9.0"
        working_directory: "terraform/backend"
        execution_mode: remote
        auto_apply: false
        
        trigger_prefixes:
          - "terraform/backend/"
        
        vcs_repo:
          identifier: "CloudbrokerAz/sales-portal"
          branch: "main"
        
        variables:
          - key: api_version
            value: v2
            category: terraform
          
          - key: rate_limit
            value: "1000"
            category: terraform
